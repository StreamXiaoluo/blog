---
title: 正则表达式基础
tags:
---
# 正则表达式30分钟入门教程

> 版本：v2.4.1 (2019-11-15) 作者：[deerchao](https://deerchao.cn/) 转载请注明[来源](https://deerchao.cn/tutorials/regex/regex.htm)

## 目录

- [正则表达式30分钟入门教程](#正则表达式30分钟入门教程)
  - [目录](#目录)
  - [本文目标](#本文目标)
  - [如何使用本教程](#如何使用本教程)
  - [正则表达式到底是什么东西？](#正则表达式到底是什么东西)
  - [入门](#入门)
  - [测试正则表达式](#测试正则表达式)
  - [元字符](#元字符)
  - [字符转义](#字符转义)
  - [重复](#重复)
  - [字符类](#字符类)
  - [分枝条件](#分枝条件)
  - [分组](#分组)
  - [反义](#反义)
  - [后向引用](#后向引用)
  - [零宽断言](#零宽断言)
  - [负向零宽断言](#负向零宽断言)
  - [注释](#注释)
  - [贪婪与懒惰](#贪婪与懒惰)
  - [处理选项](#处理选项)
  - [平衡组/递归匹配](#平衡组递归匹配)
  - [还有些什么东西没提到](#还有些什么东西没提到)
  - [网上的资源及本文参考文献](#网上的资源及本文参考文献)

---

## 本文目标

30分钟内让你明白正则表达式是什么，并对它有一些基本的了解，让你可以在自己的程序或网页里使用它。

## 如何使用本教程

别被下面那些复杂的表达式吓倒，只要跟着我一步一步来，你会发现正则表达式其实并没有想像中的那么困难。当然，如果你看完了这篇教程之后，发现自己明白了很多，却又几乎什么都记不得，那也是很正常的——我认为，没接触过正则表达式的人在看完这篇教程后，能把提到过的语法记住80%以上的可能性为零。这里只是让你明白基本的原理，以后你还需要多练习，多使用，才能熟练掌握正则表达式。

## 正则表达式到底是什么东西？

在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。

## 入门

学习正则表达式的最好方法是从例子开始，理解例子之后再自己对例子进行修改，实验。

## 测试正则表达式

由于难于读写，容易出错，所以找一种工具对正则表达式进行测试是很有必要的。

## 元字符

现在你已经知道几个很有用的元字符了，如`\b`、`.`、`*`，还有`\d`。正则表达式里还有更多的元字符，比如`\s`匹配任意的空白符，包括空格，制表符(Tab)，换行符，中文全角空格等。`\w`匹配字母或数字或下划线或汉字等。
<center>表1 常用的元字符</center>

| 代码 | 说明                           |
|------|--------------------------------|
| .    | 匹配除换行符以外的任意字符     |
| \w   | 匹配字母或数字或下划线或汉字   |
| \s   | 匹配任意的空白符               |
| \d   | 匹配数字                       |
| \b   | 匹配单词的开始或结束           |
| ^    | 匹配字符串的开始               |
| $    | 匹配字符串的结束               |


## 字符转义

如果你想查找元字符本身的话，就需要使用`\`来取消这些字符的特殊意义。因此，你应该使用`\.`和`\*`。当然，要查找`\`本身，你也得用`\\`。

## 重复

你已经看过了前面的`*`、`+`、`{n}`、`{n,}`和`{n,m}`这几个匹配重复的方式了。

<center>表2.常用的限定符</center>

| 代码/语法 | 说明                        |
|:--------:|:----------------------------:|
| *        | 重复零次或更多次             |
| +        | 重复一次或更多次             |
| ?        | 重复零次或一次               |
| {n}      | 重复n次                      |
| {n,}     | 重复n次或更多次              |
| {n,m}    | 重复n到m次                   |

## 字符类

要想查找数字、字母或者空白，可以使用字符类`[0-9]`、`[a-z]`和`\s`。你也可以使用反义字符类`[^0-9]`来匹配任意不是数字的字符。

## 分枝条件

正则表达式里的分枝条件指的是有几种规则，如果满足其中任意一种规则都应该当成匹配，具体方法是用`|`把不同的规则分隔开。

## 分组

我们可以用小括号来指定一个子表达式(分组)，然后你就可以指定这个子表达式的重复次数了。
## 反义
<center>表3.常用的反义代码</center>


| 代码/语法 | 说明                                |
|:--------:|:------------------------------------:|
| \W       | 匹配任意不是字母，数字，下划线，汉字的字符 |
| \S       | 匹配任意不是空白符的字符                 |
| \D       | 匹配任意非数字的字符                     |
| \B       | 匹配不是单词开头或结束的位置              |
| [^x]     | 匹配除了x以外的任意字符                   |
| [^aeiou] | 匹配除了aeiou这几个字母以外的任意字符     |



## 后向引用

使用小括号指定一个子表达式后，匹配这个子表达式的文本(也就是分组捕获的内容)可以在表达式或其它程序中作进一步的处理。
<center>表4.常用分组语法</center>


| 分类      | 代码/语法    | 说明                                                |
|:---------:|:-----------:|:---------------------------------------------------:|
| 捕获      | (exp)       | 匹配exp，并捕获文本到自动命名的组里                  |
|           | (?<name>exp) | 匹配exp，并捕获文本到名称为name的组里，也可以写成(?'name'exp) |
|           | (?:exp)     | 匹配exp，不捕获匹配的文本，也不给此分组分配组号       |
| 零宽断言  | (?=exp)     | 匹配exp前面的位置                                    |
|           | (?<=exp)    | 匹配exp后面的位置                                    |
|           | (?!exp)     | 匹配后面跟的不是exp的位置                            |
|           | (?<!exp)    | 匹配前面不是exp的位置                                |
| 注释      | (?#comment) | 这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读 |




## 零宽断言

零宽断言用于查找在某些内容(但并不包括这些内容)之前或之后的东西，它们是`\b`、`^`、`$`的一种泛化。

## 负向零宽断言

负向零宽断言用于确保某个字符没有出现，但并不想去匹配它。

## 注释

小括号的另一种用途是通过语法`(?#comment)`来包含注释。

## 贪婪与懒惰

正则表达式中包含能接受重复的限定符时，通常的行为是匹配尽可能多的字符。使用`?`可以转化为懒惰匹配模式，即尽可能少的匹配字符。

<center>表5.懒惰限定符</center>


| 代码/语法 | 说明                                 |
|:--------:|:------------------------------------:|
| *?       | 重复任意次，但尽可能少重复              |
| +?       | 重复1次或更多次，但尽可能少重复           |
| ??       | 重复0次或1次，但尽可能少重复              |
| {n,m}?   | 重复n到m次，但尽可能少重复                |
| {n,}?    | 重复n次以上，但尽可能少重复               |




## 处理选项

处理正则表达式的方式可以通过一些选项来改变，比如忽略大小写(`IgnoreCase`)，多行模式(`Multiline`)。

<center>表6.常用的处理选项</center>


|   名称    |               说明               |
|:---------:|:--------------------------------:|
| IgnoreCase(忽略大小写) | 匹配时不区分大小写。 |
| Multiline(多行模式) | 更改^和$的含义，使它们分别在任意一行的行首和行尾匹配，而不仅仅在整个字符串的开头和结尾匹配。(在此模式下,$的精确含意是:匹配\n之前的位置以及字符串结束前的位置.) |
| Singleline(单行模式) | 更改.的含义，使它与每一个字符匹配（包括换行符\n）。 |
| IgnorePatternWhitespace(忽略空白) | 忽略表达式中的非转义空白并启用由#标记的注释。 |
| ExplicitCapture(显式捕获) | 仅捕获已被显式命名的组。 |




## 平衡组/递归匹配

平衡组的一个最常见的应用就是匹配嵌套的结构，如HTML标签等。

## 还有些什么东西没提到

还有很多未提到的元素，如`\a`、`\e`、`\0nn`、`\xnn`等，可以在网上找到更详细的参考资料来学习它们。

<center>表7.尚未详细讨论的语法</center>


| 代码/语法      | 说明                                  |
|:-------------:|:-------------------------------------:|
| \a            | 报警字符(打印它的效果是电脑嘀一声)            |
| \b            | 通常是单词分界位置，但如果在字符类里使用代表退格  |
| \t            | 制表符，Tab                            |
| \r            | 回车                                  |
| \v            | 竖向制表符                               |
| \f            | 换页符                                 |
| \n            | 换行符                                 |
| \e            | Escape                               |
| \0nn          | ASCII代码中八进制代码为nn的字符               |
| \xnn          | ASCII代码中十六进制代码为nn的字符              |
| \unnnn        | Unicode代码中十六进制代码为nnnn的字符            |
| \cN          | ASCII控制字符。比如\cC代表Ctrl+C             |
| \A           | 字符串开头(类似^，但不受处理多行选项的影响)       |
| \Z           | 字符串结尾或行尾(不受处理多行选项的影响)         |
| \z           | 字符串结尾(类似$，但不受处理多行选项的影响)        |
| \G           | 当前搜索的开头                             |
| \p{name}     | Unicode中命名为name的字符类，例如\p{IsGreek}   |
| (?>exp)      | 贪婪子表达式                              |
| (?<x>-<y>exp) | 平衡组                                |
| (?im-nsx:exp) | 在子表达式exp中改变处理选项                 |
| (?im-nsx)    | 为表达式后面的部分改变处理选项                |
| (?(exp)yes\|no) | 把exp当作零宽正向先行断言，如果在这个位置能匹配，使用yes作为此组的表达式；否则使用no |
| (?(exp)yes)    | 同上，只是使用空表达式作为no                |
| (?(name)yes\|no) | 如果命名为name的组捕获到了内容，使用yes作为表达式；否则使用no |
| (?(name)yes)   | 同上，只是使用空表达式作为no                 |




## 网上的资源及本文参考文献

- [精通正则表达式(第3版)](https://u.jd.com/0yfKdc)
- [微软的正则表达式教程](https://docs.microsoft.com/zh-cn/dotnet/standard/base-types/regular-expressions)
- [专业的正则表达式教学网站(英文)](http://www.regular-expressions.info/)

